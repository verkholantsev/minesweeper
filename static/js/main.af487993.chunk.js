(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{140:function(e,n,t){e.exports=t(356)},145:function(e,n,t){},348:function(e,n,t){},350:function(e,n,t){},352:function(e,n,t){},354:function(e,n,t){},356:function(e,n,t){"use strict";t.r(n);var a=t(10),r=t.n(a),i=t(133),o=t.n(i),c=(t(145),t(134)),u=t(135),s=t(138),l=t(136),f=t(139),d=t(137),v=t(43);t(147),t(348);var h=function(e){var n=e.hasFlag,t=e.hasMine,a=e.isOpened,i=e.nearestMinesCount,o=e.onClick,c=e.onContextMenu,u="Square";a&&(u="".concat(u," Square__opened Square__content_").concat(i));var s=null;return a?t?s="\ud83d\udca3":i>0&&(s=i):s=n?"\u26f3\ufe0f":"",r.a.createElement("div",{className:u,onClick:o,onContextMenu:c},s)};t(350);var m=function(e){var n=e.field,t=e.onSquareClick,a=e.onSquareRightClick,i=n.map(function(e,n){var i=e.map(function(e,i){var o="".concat(n,"-").concat(i);return r.a.createElement(h,Object.assign({},e,{key:o,onClick:function(){return t({x:n,y:i})},onContextMenu:function(e){e.preventDefault(),a({x:n,y:i})}}))});return r.a.createElement("div",{className:"GameField__row",key:n},i)});return r.a.createElement("div",{className:"GameField"},i)};t(352);function p(e){var n=e.count,t=e.className,a=1===n?"mine left":"mines left";return r.a.createElement("div",{className:"MinesLeftCount ".concat(t)},n," ",a)}t(354);var g={IN_PROGRESS:"IN_PROGRESS",WIN:"WIN",LOSE:"LOSE"};function y(e,n,t){for(var a=[],r=0;r<e;r++){a.push([]);for(var i=0;i<n;i++)a[r].push({hasFlag:!1,hasMine:!1,isOpened:!1,isVisitedTag:null,x:r,y:i})}for(var o=0;o<t;o++){var c=C(a,e,n),u=c.x,s=c.y;a[u][s].hasMine=!0}for(var l=0;l<e;l++)for(var f=0;f<n;f++)a[l][f].nearestMinesCount=S(a,l,f);return a}function w(e,n,t){return[{x:n-1,y:t},{x:n-1,y:t+1},{x:n,y:t+1},{x:n+1,y:t+1},{x:n+1,y:t},{x:n+1,y:t-1},{x:n,y:t-1},{x:n-1,y:t-1}].filter(function(n){var t=n.x,a=n.y,r=e[t];return!!r&&!!r[a]})}function S(e,n,t){var a=0;return function(e,n,t,a){w(e,n,t).forEach(function(n){var t=n.x,r=n.y,i=e[t][r];a(i,t,r)})}(e,n,t,function(e){e.hasMine&&a++}),a}function C(e,n,t){var a=Math.round(Math.random()*(n-1)),r=Math.round(Math.random()*(t-1));return 1===e[a][r].hasMine?C(e,n,t):{x:a,y:r}}function O(e,n,t,a){var r=e.field,i=r[n][t],o=i.hasFlag,c=i.hasMine;if(o)return e;if(c)return Object(v.a)({},e,{field:x(r),gameState:g.LOSE});for(var u=[r[n][t]],s=(new Date).valueOf();u.length>0;){var l=u.shift();if(!l.hasFlag&&(l.isOpened=!0,0===l.nearestMinesCount&&!l.hasMine)){var f=w(r,l.x,l.y).map(function(e){var n=e.x,t=e.y;return r[n][t]}).filter(function(e){return e.isVisitedTag!==s});f.forEach(function(e){e.isVisitedTag=s}),u.push.apply(u,Object(d.a)(f))}}return function(e){var n=0,t=!0,a=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var c=i.value,u=!0,s=!1,l=void 0;try{for(var f,d=c[Symbol.iterator]();!(u=(f=d.next()).done);u=!0){var v=f.value;v.isOpened||n++}}catch(h){s=!0,l=h}finally{try{u||null==d.return||d.return()}finally{if(s)throw l}}}}catch(h){a=!0,r=h}finally{try{t||null==o.return||o.return()}finally{if(a)throw r}}return n}(r)===a?Object(v.a)({},e,{field:x(r),gameState:g.WIN}):Object(v.a)({},e,{field:r})}function x(e){for(var n=0;n<e.length;n++)for(var t=0;t<e[n].length;t++)e[n][t]=Object(v.a)({},e[n][t],{isOpened:!0});return e}var E=function(e){function n(e){var t;Object(c.a)(this,n),t=Object(s.a)(this,Object(l.a)(n).call(this,e));var a=e.minesCount,r=e.width,i=e.height;return t.state={closedSquaresCount:r*i,field:y(r,i,a),gameState:g.IN_PROGRESS,minesLeftCount:a},t}return Object(f.a)(n,e),Object(u.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},this._renderGameState(),r.a.createElement("div",{className:"App__gameFieldWrapper"},r.a.createElement(m,{field:this.state.field,onSquareClick:function(n){return e._onSquareClick(n)},onSquareRightClick:function(n){return e._onSquareRightClick(n)}})))}},{key:"_renderGameState",value:function(){var e=this.state,n=e.gameState,t=e.minesLeftCount;switch(n){case g.IN_PROGRESS:return r.a.createElement(p,{className:"App__mineLeftCount",count:t});case g.WIN:return r.a.createElement("div",{className:"App__mineLeftCount"},"\ud83d\ude0e");case g.LOSE:return r.a.createElement("div",{className:"App__mineLeftCount"},"\ud83d\ude2b");default:throw new Error("Unexpected game state: ".concat(n))}}},{key:"_onSquareClick",value:function(e){var n=e.x,t=e.y,a=O(this.state,n,t,this.props.minesCount);this.setState(function(){return a})}},{key:"_onSquareRightClick",value:function(e){var n=e.x,t=e.y,a=this.state.field[n][t],r=a.isOpened,i=a.hasFlag,o=this.state.minesLeftCount;if(!r&&(0!==o||i)){var c=function(e,n,t){var a=e.field,r=e.minesLeftCount,i=a[n][t],o=i.hasFlag;return i.isOpened||0===r&&!o?e:(a[n][t]=Object(v.a)({},a[n][t],{hasFlag:!o}),Object(v.a)({},e,{field:a,minesLeftCount:o?r+1:r-1}))}(this.state,n,t);this.setState(function(){return c})}}}]),n}(a.Component);E.defaultProps={height:10,minesCount:10,width:10};var k=E,_=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function N(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}o.a.render(r.a.createElement(k,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/minesweeper",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/minesweeper","/service-worker.js");_?function(e){fetch(e).then(function(n){404===n.status||-1===n.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):N(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e):N(e)})}}()}},[[140,2,1]]]);
//# sourceMappingURL=main.af487993.chunk.js.map